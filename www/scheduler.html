<!DOCTYPE html>

<!--
/*
 * Copyright 2014 Red Folder Consultancy Ltd
 *   
 * Licensed under the Apache License, Version 2.0 (the "License");   
 * you may not use this file except in compliance with the License.   
 * You may obtain a copy of the License at       
 * 
 * 	http://www.apache.org/licenses/LICENSE-2.0   
 *
 * Unless required by applicable law or agreed to in writing, software   
 * distributed under the License is distributed on an "AS IS" BASIS,   
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.   
 * See the License for the specific language governing permissions and   
 * limitations under the License.
 */
-->

<html>
    <head>
        <title>Scheduler</title>
    </head>
    <body>
		<table>
			<tr>
				<th colspan=3 align="center">When</th>
			</tr>
			<tr>
				<th align="left">Day</th>
				<td colspan=2 align="center"><input id="dayTxt" type="Text"/></td>
			</tr>
			<tr>
				<th align="left">Month</th>
				<td colspan=2 align="center"><input id="monthTxt" type="Text"/></td>
			</tr>
			<tr>
				<th align="left">Year</th>
				<td colspan=2 align="center"><input id="yearTxt" type="Text"/></td>
			</tr>

			<tr>
				<th align="left">Hour</th>
				<td colspan=2 align="center"><input id="hourTxt" type="Text"/></td>
			</tr>
			<tr>
				<th align="left">Minute</th>
				<td colspan=2 align="center"><input id="minuteTxt" type="Text"/></td>
			</tr>

			<tr>
				<td colspan=3 align="center"><input disabled id="updateBtn" type="button" value="Update"/></td>
			</tr>

		</table>
        
        <script type="text/javascript" src="cordova.js"></script>
        

        
        <script type="text/javascript">
   			var scheduler;

   			document.addEventListener('deviceready', function() {
   				
      			scheduler = cordova.plugins.scheduler;

				updateView();
   			}, true);
   			  
   			function update() {
   				now = new Date();
   				when = new Date(now.getTime() + (30 * 1000));
   			
   				scheduler.setAlarm(	when,
   									function(data) { updateView(data) }, 
   									function(data) { displayError(data) });
   									
   				alert("Alarm set");
   			}
   			
   			function displayResult(data) {
      			alert("Working: " + JSON.stringify(data));
   			}

   			function displayError(data) {
      			alert(data.ErrorMessage);
   			}
   			
   			/*
			 * View logic
			 */
 			/*function updateView(data) {*/
 			function updateView() {
				var updateBtn = document.getElementById("updateBtn");
				
				updateBtn.onclick = update;
				updateBtn.disabled = false;
   			}
   			
   		</script>
    </body>
</html>
